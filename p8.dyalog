p←'\w+'⎕S'&'¨⊃⎕NGET'p8.txt'1
+/2 3 4 7∊⍨∊≢¨¨10↓¨p ⍝ part 1
f←{⍺←,⊂7/1 ⋄ 0=≢⍵:↑1↓⍺ ⋄ m←(⍳≢⍵)=⊃⍋+/¨⍵∘.∧⍺ ⋄ (⍺,m/⍵)∇(~m)/⍵}
g←{10⊥1 7 4 2 5 3 6 0 9 8[(f 10↑⍵)∘⍳¨10↓⍵]}
+/g¨'abcdefg'∘∊¨¨p ⍝ part 2
