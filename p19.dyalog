⎕IO←0
m←↑{∪⍵,,({⍵(1⌽1⊖⍵)}3 3⍴1 0 0 0 0 1 0 ¯1 0)∘.(+.×)⍵}⍣≡,⊂∘.=⍨⍳3
q←m∘(+.×⍤2 1⍤2)¨p←↑¨⍎¨¨'-'⎕R'¯'¨¨1↓¨{⍵⊆⍨×≢¨⍵}⊃⎕NGET'p19.txt'1
t←0
a←(⊃p){0=≢⍵:⍺ ⋄ i j←⊃⍸12≤⊢/z←↑⍺∘{{{⍵⌷⍨r⍳⌈/r←⊢/⍵}{⍺,≢⍵}⌸⍵}⍤2,[1 2]⍵-⍤1⍤1 2⊢⍺}¨⍵ ⋄ (∪⍺⍪(j⌷i⊃⍵)-⍤1⊢d⊣t⌈←+/|d←i j(⍳3)⌷z)∇⍵/⍨i≠⍳≢⍵}1↓q
≢a ⍝ part 1
t ⍝ part 2
