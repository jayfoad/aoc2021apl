⎕IO←0 ⋄ ⎕PP←17
p←,⍉(4/2)⊤(⎕D,⎕A)⍳⊃⊃⎕NGET'p16.txt'1
{4>≢⍵:0 ⋄ (2⊥3↑⍵)+∇⍵↓⍨{1 0 0≡3↓6↑⍵:5+⍵{⍵+5×⍵⊃⍺}⍣≡6 ⋄ 22-4×6⊃⍵}⍵}p ⍝ part 1
x←⎕NS¨8⍴⊂''
x[0].f←+ ⋄ x[1].f←× ⋄ x[2].f←⌊ ⋄ x[3].f←⌈ ⋄ x[5].f←> ⋄ x[6].f←< ⋄ x[7].f←=
f←{4=t←2⊥3↓6↑⍵:fn 6↓⍵ ⋄ 6⊃⍵:x[t].f/fc 7↓⍵ ⋄ x[t].f/fl 7↓⍵}
fn←{z←5+⍵{⍵+5×⍵⊃⍺}⍣≡0 ⋄ (2⊥(z⍴~5↑1)/z↑⍵)(z↓⍵)}
fc←{v w←(2⊥11↑⍵){⍺=0:⍬⍵ ⋄ n w←f ⍵ ⋄ v w←(⍺-1)∇w ⋄ (n,v)w}11↓⍵ ⋄ (⍺⍺ v)w}
fl←{v w←((≢⍵)-15+2⊥15↑⍵){⍺=≢⍵:⍬⍵ ⋄ n w←f ⍵ ⋄ v w←⍺∇w ⋄ (n,v)w}15↓⍵ ⋄ (⍺⍺ v)w}
⊃f p ⍝ part 2
