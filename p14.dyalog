⎕PP←17
s←∪⊃p←⊃⎕NGET'p14.txt'1
a←s∘⍳¨2↑¨2↓p ⋄ b←s⍳⊃∘⌽¨2↓p
c←(b,⍨¨⊃¨a)@a⊢∘.,⍨s ⋄ d←(b,¨⊃∘⌽¨a)@a⊢∘.,⍨s
t←⍸⍣¯1{⍵[⍋⍵]}2,/s⍳⊃p
f←{¯1+(⌈/-⌊/)+/{z⊣z[c]+←z[d]+←⍵⊣z←0×⍵}⍣⍺⊢⍵}
10 f t ⍝ part 1
40 f t ⍝ part 2
