⎕IO←0
p←⍎¨↑⊃⎕NGET'p15.txt'1
f←{z←+/,⍵ ⋄ g←{⍵⌊⍺+(z⍪⍨1↓⍵)⌊z⍪¯1↓⍵} ⋄ ⊃⌽,⍵{⍺ g⍤1⊢⍺ g ⍵}⍣≡z-z↑⍨⍴⍵}
f p ⍝ part 1
f 1+9|¯1+(5×⍴p)⍴0 2 1 3⍉↑(∘.+⍨⍳5)+⊂p ⍝ part 2
