p←⍎¨↑⊃⎕NGET'p9.txt'1
+/,(1+p)×{⍵<{⌊/(9⍴0 1)/,⍵}⌺3 3⊢⍵}p-10 ⍝ part 1
×/3↑{⍵[⍒⍵]}{≢⍵}⌸0~⍨,{(p≠9)×⌈/0 1 0 1 1 1 0 1 0/{,⍵}⌺3 3⊢⍵}⍣≡(⍴p)⍴⍳≢,p ⍝ part 2
