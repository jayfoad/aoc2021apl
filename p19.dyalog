⎕IO←0
m←↑{∪⍵,,({⍵(1⌽1⊖⍵)}3 3⍴1 0 0 0 0 1 0 ¯1 0)∘.(+.×)⍵}⍣≡,⊂∘.=⍨⍳3
q←m∘(+.×⍤2 1⍤2)¨p←↑¨⍎¨¨'-'⎕R'¯'¨¨1↓¨{⍵⊆⍨×≢¨⍵}⊃⎕NGET'p19.txt'1
a b←(⊃p)(1 3⍴0){0=≢⍵:⍺ ⋄ a b←⍺ ⋄ j/⍨←i←(1⊃⍴z)>j←+/∧\12>⊢/z←↑a∘{{{⍵⌷⍨r⍳⌈/r←⊢/⍵}{⍺,≢⍵}⌸⍵}⍤2,[1 2]⍵-⍤1⍤1 2⊢⍺}¨⍵ ⋄ (∪a⍪⊃⍪/(j⌷¨i/⍵)-⍤1¨↓c)(b⍪c←0 ¯1↓j⌷⍤0 2⊢i⌿z)∇ ⍵/⍨~i}1↓q
≢a ⍝ part 1
⌈/,+/|-⍤1⍤1 2⍨b ⍝ part 2
